@using WebLibrary.IdentityExtensions

@{
    ViewBag.Title = "Transfers";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />
<div class="row justify-content-center visibility4">
    <div class="col  pt-4 pb-1  jumbotron">
        <table id="allTransfers" class="table table-bordered table-hover" style="width:100%">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Transfer Id</th>
                    <th>From</th>
                    <th>To</th>
                    <th>CashAmount</th>
                    <th>Date</th>
                </tr>
            </thead>
        </table>
    </div>
</div>



<script>
    $(document).ready(function () {
        var usernameId = @HttpContext.Current.User.Identity.GetUserId().Value;
        $('#allTransfers').DataTable({
            "ajax": { url: "/api/MoneyTransfer/GetAllTransfers", dataSrc: "" },
            "paging":   true,
            "order": [[5, "desc"]],
            "info": true,
            "searching": true,
            "columns": [
                { "data": "name" },
                { "data": "id" },
                { "data": "from.userName"},
                { "data": "to.userName" },
                {
                    "data": "cashAmount", "render": function (data, type, row, meta) {
                        if (row.from.id == usernameId) {
                            data = -data;
                        }

                    return data.toFixed(2).toLocaleString() + " PLN";
                } },
                { "data": "createdOn", "render": function(data, type, row, meta) {

                    return data.substring(0,10);
                }}
            ],
            "rowCallback": function(row, data, index) {

                if (data.from.id === usernameId) {
                    $('td', row).css('color', '#ff3232');
                    $('td', row).css('font-weight', '500');
                } else {
                    $('td', row).css('color', '#50C878');
                    $('td', row).css('font-weight', '500');
                }
            }
        });
    });

</script>

