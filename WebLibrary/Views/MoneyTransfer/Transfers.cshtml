@using WebLibrary.IdentityExtensions

@{
    ViewBag.Title = "Transfers";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />*@
<div class="row mt-5 px-4 justify-content-center visibility4">
    <div class="col  pt-4 pb-1  jumbotron">
        <h2 class="display-4 mb-5 text-center">All transfers</h2>
        <table id="allTransfers" class="table table-striped table-bordered" style="width: 100%">
            <thead>
            <tr>
                <th>Name</th>
                <th>Transfer Id</th>
                <th>From</th>
                <th>To</th>
                <th>CashAmount</th>
                <th>Date</th>
            </tr>
            </thead>
        </table>
    </div>
</div>



<script>
    $(document).ready(function () {
        var userId = @ViewBag.Id;
        $('#allTransfers').DataTable({
            "ajax": { url: "/api/MoneyTransfer/GetAllTransfers", dataSrc: "" },
            "paging":   false,
            "order": [[5, "desc"]],
            "info": false,
            "searching": false,
            "columns": [
                { "data": "name" },
                { "data": "id" },
                { "data": "from.userName"},
                { "data": "to.userName" },
                {
                    "data": "cashAmount", "render": function (data, type, row, meta) {
                        if (row.from.id == userId) {
                            data = -data;
                        }

                    return data.toFixed(2).toLocaleString() + " PLN";
                } },
                { "data": "createdOn", "render": function(data, type, row, meta) {

                    return data.substring(0,10);
                }}
            ],
            "rowCallback": function(row, data, index) {

                if (data.from.id === userId) {
                    $('td', row).css('color', '#ff3232');
                    $('td', row).css('font-weight', '500');
                } else {
                    $('td', row).css('color', '#50C878');
                    $('td', row).css('font-weight', '500');
                }
            }
        });
    });

</script>

